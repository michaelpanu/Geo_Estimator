<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Panorama</title>
    <style>
        html,
        body,
        #map-canvas {
            height: 100%;
            margin: 0px;
            padding: 0px
        }
    </style>
    <script
        
        src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initialize&v=weekly"
        async defer></script>
    
    <script>
  window.initialize = function () {
    const { lat, lng } = getCoords();
    const pos = new google.maps.LatLng(lat, lng);

    const pano = new google.maps.StreetViewPanorama(
      document.getElementById("map-canvas"),
      {
        addressControl: false,
        showRoadLabels: true,
        fullscreenControl: false,
      }
    );

    const svc = new google.maps.StreetViewService();
    svc.getPanorama(
      { location: pos, radius: 5000, source: google.maps.StreetViewSource.GOOGLE },
      (data, status) => {
        if (status !== "OK" || !data?.location?.pano) {
          console.error("Free Points!!:", lat, lng, "status:", status);
          document.body.innerHTML =
            "<div style='font:16px sans-serif;padding:20px'>No Street View panorama near these coordinates.</div>";
          return;
        }

        pano.setPano(data.location.pano);
        pano.setPov({ heading: 165, pitch: 0 });
        pano.setVisible(true);
      }
    );
  };

  function getCoords() {
    const params = new URLSearchParams(window.location.search);
    const lat = Number(params.get("lat"));
    const lng = Number(params.get("lng"));
    return { lat, lng };
  }
</script>
</head>

<body>
    <div id="map-canvas"></div>
</body>

</html>